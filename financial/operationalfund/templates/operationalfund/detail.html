{% extends 'base-form.html' %}
{% load staticfiles %}
{% load humanize %}
{% block page-title %} Operational Fund {% endblock page-title %}
{% block extra_css %}
    <link rel="stylesheet" href="{% static 'financial-layout/assets/css/dashboard/dashboard.css' %}" />
    <style>
        .text-name-profile.text-info {
            width: 30%;
        }
        .detail-profile {
            width: 50%;
        }
        .heading-top-index-2 {
            padding-right: 20px;
            padding-left: 20px;
        }
        .vattable td {
            text-align: right;

        }
        .vattable td:first-child {
            width: 170px;
            padding-right: 20px;
        }
        .vattable td input {
            width: 100px;
            text-align: right;
        }
        .widgett {
            margin-bottom: 10px;
        }
        .badge{
            margin-top: 3px;
            color: transparent;
            text-shadow: none;
            padding: 3px 5px 3px;
        }
        .rotate-up {
            -webkit-transform: rotate(180deg);
            -webkit-transition: -webkit-transform .5s;
        }
        .rotate-down {
            -webkit-transform: rotate(0deg);
            -webkit-transition: -webkit-transform .5s;
        }
        .rotate-icon{
            display: inline-block;
        }
        li.active
        {
            font-size: 12px;
        }
    </style>
{% endblock extra_css %}
{% block page-content %}
<div class="page-content container-fluid page">
    <div class="row">
        <div class="row col-md-12">
            <div class="col-md-9">
                <!-- Start Profile Tab Section -->
                <div class="nav-tabs nav-tabs-animate border-profile">
                    <div class="pull-right">
    {#                    <a href="{% url 'canvasssheet:pdf' object.id %}" target="_blank"><button type="button" id="get_pdf" class="btn btn-info btn-sm waves-effect waves-light get_report">#}
    {#                        <i class="icon fa-file-pdf-o" aria-hidden="true"></i>&nbsp; Print#}
    {#                    </button></a>#}
                        <a href="{% url 'operationalfund:userpdf' object.id %}" target="_blank" class="floatright">
                        <button type="button" id="get_pdf" class="btn btn-round btn-info btn-sm waves-effect
                        waves-light get_report">
                            <i class="icon fa-file-pdf-o" aria-hidden="true"></i>&nbsp; Print
                        </button>
                              </a>
                        {% if object.oftype_id == 8  %}
                            {% if object.hrstatus == 'F' %}
                                <button type="button" id="hr_approved" class="btn btn-round btn-success btn-sm waves-effect
                            waves-light hr_approved">
                                <i class="icon fa-thumbs-up" aria-hidden="true"></i>&nbsp; HR Approved
                            </button>
                            <button type="button" id="hr_disapproved" class="btn btn-round btn-danger btn-sm waves-effect
                            waves-light hr_approved">
                                <i class="icon fa-thumbs-down" aria-hidden="true"></i>&nbsp; HR Disapproved
                            </button>
                            {% endif %}
                        {% endif %}
                        {% if object.oftype_id == 9 or object.oftype_id == 10  %}
                            {% if object.hrstatus == 'F' and object.nurse_approved == 'F' and user.id ==  274 %}
                            <button type="button" id="nurse_approved" class="btn btn-round btn-success btn-sm waves-effect
                            waves-light hr_approved">
                                <i class="icon fa-thumbs-up" aria-hidden="true"></i>&nbsp; Nurse Approved
                            </button>
                            <button type="button" id="nurse_disapproved" class="btn btn-round btn-danger btn-sm waves-effect
                            waves-light hr_approved">
                                <i class="icon fa-thumbs-down" aria-hidden="true"></i>&nbsp; Nurse Disapproved
                            </button>
                            {% endif %}

                            {% if object.hrstatus == 'F' and object.nurse_approved == 'A' and object.hr_approved_lvl1 == 'F' and object.hr_approved_lvl2 == 'F' and aemp.of_approver == 4 %}
                            <button type="button" id="hr1_approved" class="btn btn-round btn-success btn-sm waves-effect
                            waves-light hr_approved">
                                <i class="icon fa-thumbs-up" aria-hidden="true"></i>&nbsp; (1) HR Approved
                            </button>
                            <button type="button" id="hr1_disapproved" class="btn btn-round btn-danger btn-sm waves-effect
                            waves-light hr_approved">
                                <i class="icon fa-thumbs-down" aria-hidden="true"></i>&nbsp; (1) HR Disapproved
                            </button>
                            {% endif %}

                            {% if object.hrstatus == 'F' and object.nurse_approved == 'A' and object.hr_approved_lvl1 == 'A' and object.hr_approved_lvl2 == 'F' and aemp.of_approver == 5 %}
                            <button type="button" id="hr2_approved" class="btn btn-round btn-success btn-sm waves-effect
                            waves-light hr_approved">
                                <i class="icon fa-thumbs-up" aria-hidden="true"></i>&nbsp; (2) HR Approved
                            </button>
                            <button type="button" id="hr2_disapproved" class="btn btn-round btn-danger btn-sm waves-effect
                            waves-light hr_approved">
                                <i class="icon fa-thumbs-down" aria-hidden="true"></i>&nbsp; (2) HR Disapproved
                            </button>
                            {% endif %}


                            {% if object.hrstatus == 'F' and object.nurse_approved == 'A' and object.hr_approved_lvl1 == 'A' and object.hr_approved_lvl2 == 'A' and aemp.of_approver == 6  %}
                                <button type="button" id="hr_approved" class="btn btn-round btn-success btn-sm waves-effect
                            waves-light hr_approved">
                                <i class="icon fa-thumbs-up" aria-hidden="true"></i>&nbsp; HR Approved
                            </button>
                            <button type="button" id="hr_disapproved" class="btn btn-round btn-danger btn-sm waves-effect
                            waves-light hr_approved">
                                <i class="icon fa-thumbs-down" aria-hidden="true"></i>&nbsp; HR Disapproved
                            </button>
                            {% endif %}


                        {% endif %}

                    </div>
                    <ul class="nav nav-tabs nav-profile">
                        <li role="presentation" class="active"><a data-toggle="tab" href="#profiles" aria-controls="profiles" role="tab">Main Details</a></li>
                    </ul>
                    <div class="tab-content padding-top-0">
                        <div class="tab-pane active" id="profiles" role="tabpanel">
                            <div class="panel top-profile skill-profile margin-bottom-25">
                                <div class="panel-body small">
                                    <!-- <h4 class="list-title">Personal Information</h4> -->
                                    <div class="row">
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-2 margin-right-80"><b>Number</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span><b>OF-{{ object.oftype.code }}-{{ object.ofnum }}</b></span>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-1 margin-right-60"><b>OF&nbsp;Date</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span>{{ object.ofdate|date:'Y-m-d' }}</span>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-2 margin-right-80"><b>Requested&nbsp;Amount</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span>{{ object.amount|floatformat:2|intcomma }}</span>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-1 margin-right-60"><b>Type</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span>{{ object.oftype.description|default:'N/A' }}</span>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-2 margin-right-80"><b>Approved&nbsp;Amount</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span>{{ object.approvedamount|floatformat:2|intcomma }}</span>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-1 margin-right-60"><b>Ref.&nbsp;No.</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span>{{ object.refnum|default:'N/A' }}</span>
                                            </div>
                                        </div>
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <div class="first-name-profile">
                                                <br>
                                                <span class="text-info row col-md-1" style="margin-right: 78px;"><b>Employee</b></span>
                                                <span class="text-info row col-md-1" style="margin-right: 15px;"><b>: </b></span>
                                                <span><b>{{ object.requestor_name }}</b></span>
                                            </div>
                                        </div>
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-1" style="margin-right: 78px;"><b>Department</b></span>
                                                <span class="text-info row col-md-1" style="margin-right: 15px;"><b>: </b></span>
                                                <span><b>{{ object.department_name }}</b></span>
                                            </div>
                                        </div>
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-1" style="margin-right: 78px;"><b>Particulars</b></span>
                                                <span class="text-info row col-md-1" style="margin-right: 15px;"><b>: </b></span>
                                                <span><b>{{ object.particulars }}</b></span>
                                            </div>
                                        </div>
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-1" style="margin-right: 78px;"><b>Branch</b></span>
                                                <span class="text-info row col-md-1" style="margin-right: 15px;"><b>: </b></span>
                                                <span><b>{{ object.branch.description }}</b></span>
                                            </div>
                                        </div>
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-1" style="margin-right: 78px;"><b>Credit&nbsp;Terms</b></span>
                                                <span class="text-info row col-md-1" style="margin-right: 15px;"><b>: </b></span>
                                                <span><b>{{ object.creditterm.description|default:'N/A' }}</b></span>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <br>
                                                <span class="text-info row col-md-2 margin-right-80"><b>OF&nbsp;Status</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span class="{% if object.ofstatus == 'F' %} text-primary
                                                             {% elif object.ofstatus == 'A' or object.ofstatus == 'R' %} text-success
                                                             {% elif object.ofstatus == 'D' %} text-danger
                                                             {% endif %}"><b>{{ object.get_ofstatus_display }}</b></span>
                                            </div>
                                        </div>


                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <br>
                                                <span class="text-info row col-md-1 margin-right-60"><b>Approver</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span>
                                                    {% if object.oftype_id == 8 or object.oftype_id == 9 or object.oftype_id == 10 %}
                                                    {{ aemp.firstname }}&nbsp;{{ aemp.lastname }}
                                                    {% else %}
                                                        {% if object.actualapprover %}
                                                            {{ object.actualapprover.firstname }}&nbsp;{{ object.actualapprover.lastname }}
                                                        {% else %}
                                                            {{ object.designatedapprover.firstname }}&nbsp;{{ object.designatedapprover.lastname }}
                                                        {% endif %}
                                                    {% endif %}
                                                    </span>

                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-2 margin-right-80"><b>{% if object.approverresponse == 'D' %}Disapproval{% else %}Approval{% endif %}&nbsp;Date</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span>{{ object.responsedate|date:'Y-m-d'|default:'N/A' }}</span>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-1 margin-right-60"><b>Remarks</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span>{{ object.remarks|default:'N/A' }}</span>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-2 margin-right-80"><b>Release&nbsp;Date</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span>{{ object.releasedate|date:'Y-m-d'|default:'N/A' }}</span>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-1 margin-right-60"><b>Recipient</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span>
                                                    {% if object.paymentreceivedby %}
                                                        {{ object.paymentreceivedby.firstname }}&nbsp;{{ object.paymentreceivedby.lastname }}
                                                    {% else %}N/A
                                                    {% endif %}</span>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <span class="text-info row col-md-2 margin-right-80"><b>Status</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span class="{% if object.status == 'A' %} text-success
                                                             {% else %} text-danger
                                                             {% endif %}"><b>{{ object.get_status_display }}</b></span>
                                            </div>
                                        </div>
                                        {% if object.oftype_id == 8  or object.oftype_id == 9 or object.oftype_id == 10  %}
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="first-name-profile">
                                                <br>
                                                <span class="text-info row col-md-1 margin-right-80"><b>HR&nbsp;Status</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span class="{% if object.hrstatus == 'F' %} text-primary
                                                             {% elif object.hrstatus == 'A' or object.ofstatus == 'R' %} text-success
                                                             {% elif object.hrstatus == 'D' %} text-danger
                                                             {% endif %}"><b>{{ object.get_hrstatus_display }}</b></span>
                                            </div>
                                        </div>
                                        {% endif %}

                                        {% if object.oftype_id == 9 or object.oftype_id == 10 %}
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <div class="first-name-profile">

                                                <span class="text-info row col-md-2 margin-right-80"><b>Nurse Status</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span>{{ object.get_nurse_approved_display }} {% if object.nurse_approved_date %} : {{ object.nurse_approved_date|date:'Y-m-d' }}  {% endif %}</span>
                                            </div>
                                        </div>
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <div class="first-name-profile">

                                                <span class="text-info row col-md-2 margin-right-80"><b>(1) HR Status</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span>{{ object.get_hr_approved_lvl1_display }}  {% if object.hr_approved_lvl1_date %} : {{ object.hr_approved_lvl1_date|date:'Y-m-d' }}  {% endif %}</span>
                                            </div>
                                        </div>
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <div class="first-name-profile">

                                                <span class="text-info row col-md-2 margin-right-80"><b>(2) HR Status</b></span>
                                                <span class="text-info row col-md-3"><b>: </b></span>
                                                <span>{{ object.get_hr_approved_lvl2_display }}  {% if object.hr_approved_lvl2_date %} : {{ object.hr_approved_lvl2_date|date:'Y-m-d' }}  {% endif %}</span>
                                            </div>
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row col-md-3">
                <div class="col-md-12">
                    <div class="nav-tabs nav-tabs-animate border-profile">
                        <ul class="nav nav-tabs nav-profile">
                            <li role="presentation" class="active"><a data-toggle="tab" href="#profiles" aria-controls="profiles" role="tab">Replenishment</a></li>
                        </ul>
                        <div class="tab-content padding-top-0">
                            <div class="tab-pane active" id="profiles" role="tabpanel">
                                <div class="panel top-profile skill-profile margin-bottom-25">
                                            <div class="panel-body small">
                                        {% if object.oftype.code == 'PCV' %}
                                            <div class="master-degree">
                                                <span class="degree-name text-info">PCV&nbsp;Replenishment:</span>
                                                {% if object.reppcvmain %}
                                                    <div class="univer-profile">{{ object.reppcvmain.reppcvnum }}, {{ object.reppcvmain.reppcvdate|date:'Y-m-d' }}</div>
                                                {% else %}<div class="univer-profile">N/A</div>
                                                {% endif %}
                                            </div>
                                            <div class="master-degree">
                                                <span class="degree-name text-info">Check&nbsp;Voucher:</span>
                                                {% if object.cvmain %}
                                                <div class="univer-profile">{{ object.cvmain.cvnum }}, {{ object.cvmain.cvdate|date:'Y-m-d' }}</div>
                                                {% else %}<div class="univer-profile">N/A</div>
                                                {% endif %}
                                            </div>
                                        {% endif %}
                                        {% if object.oftype.code == 'RFV' %}
                                            <div class="master-degree">
                                                <span class="degree-name text-info">RFV&nbsp;Replenishment:</span>
                                                {% if object.reprfvmain %}
                                                <div class="univer-profile">{{ object.reprfvmain.reprfvnum }}, {{ object.reprfvmain.reprfvdate|date:'Y-m-d' }}</div>
                                                {% else %}<div class="univer-profile">N/A</div>
                                                {% endif %}
                                            </div>
                                            <div class="master-degree">
                                                <span class="degree-name text-info">AP&nbsp;Voucher:</span>
                                                {% if object.apmain %}
                                                <div class="univer-profile">{{ object.apmain.apnum }}, {{ object.apmain.apdate|date:'Y-m-d' }}</div>
                                                {% else %}<div class="univer-profile">N/A</div>
                                                {% endif %}
                                            </div>
                                        {% endif %}
                                        {% if object.oftype.code == 'CSV' %}
                                            <div class="master-degree">
                                                <span class="degree-name text-info">Journal&nbsp;Voucher:</span>
                                                {% if object.jvmain %}
                                                <div class="univer-profile">{{ object.jvmain.jvnum }}, {{ object.jvmain.jvdate|date:'Y-m-d' }}</div>
                                                {% else %}<div class="univer-profile">N/A</div>
                                                {% endif %}
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row col-md-12">
            <div class="col-md-12">
                <div class="nav-tabs nav-tabs-animate border-profile">
                    <ul class="nav nav-tabs nav-profile">
                        <li role="presentation" class="active"><a data-toggle="tab" href="#profiles" aria-controls="profiles" role="tab">Item Details</a></li>
                    </ul>
                    <div class="tab-content padding-top-0">
                        <div class="tab-pane active" id="profiles" role="tabpanel">
                            <div class="panel">
                                <div class="panel-body">
                                    <h4>
                                        Request Details
                                        <div class="pull-right" style="margin-right: 23px;">

                                            <small>For Approval&nbsp;&nbsp;</small> <span class="badge badge-radius badge-default">1</span>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            <small>Approved&nbsp;&nbsp;</small> <span class="badge badge-radius badge-success">1</span>
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            <small>Disapproved&nbsp;&nbsp;</small> <span class="badge badge-radius badge-danger">1</span>
                                        </div>
                                    </h4>

                                    <br>
                                    <table class="table item_table">
                                        <thead>
                                        <tr>
                                            <th>
                                                <div class="form-group col-sm-1 margin-bottom-0"></div>
                                                <div class="form-group col-sm-3 margin-bottom-0">OF Subtype</div>
                                                <div class="form-group col-sm-4 margin-bottom-0">Payee</div>
                                                <div class="form-group col-sm-2 margin-bottom-0" style="text-align: right">Amount</div>
                                                <div class="form-group col-sm-1 margin-bottom-0" style="text-align:right"></div>
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody class="small">
                                            {% for itemtemp in itemtemp %}
                                                <tr>
                                                    <td>
                                                        <div class="form-group col-sm-1 margin-bottom-0 item_counter">{{ itemtemp.item_counter }}</div>
                                                        <div class="form-group col-sm-3 margin-bottom-0">{{ itemtemp.ofsubtype.description }}</div>
                                                        <div class="form-group col-sm-4 margin-bottom-0">{% if itemtemp.supplier_name %}{{ itemtemp.supplier_name|upper }}{% else %}{{ itemtemp.payee_name|upper }}{% endif %}</div>
                                                        <div class="form-group col-sm-2 margin-bottom-0 item-amount" style="text-align: right">{{ itemtemp.amount|floatformat:2|intcomma }}</div>
                                                        <div class="form-group col-sm-2 margin-bottom-0">
                                                            <div class="rotate-icon rotate-up">
                                                                <a href="#_" style="font-size: 25px;vertical-align: top;" class="expand-fields"><i class="icon fa-sort-down" aria-hidden="true"></i></a>
                                                            </div>
                                                            <span class="pull-right badge badge-radius badge-{% if itemtemp.ofitemstatus == 'F' %}default{% elif itemtemp.ofitemstatus == 'A' %}success{% else %}danger{% endif %}">1</span>
                                                        </div>
                                                        <div class="extra-fields row col-sm-12">
                                                            <div class="form-group col-sm-1"></div>
                                                            <div class="form-group col-sm-10" style="height: 1px;"><hr></div>
                                                            <div class="form-group col-sm-1"></div>
                                                            <div class="form-group col-sm-12"></div>
                                                            <div class="form-group col-sm-1"></div>
                                                            <div class="form-group col-sm-10 padding-left-0">
                                                                <div class="form-group col-sm-4">
                                                                    <label class="control-label"><small>VAT</small></label><br>
                                                                    [{{ itemtemp.vat.code|default:' N/A ' }}] {{ itemtemp.vat.description }}
                                                                </div>
                                                                <div class="form-group col-sm-4">
                                                                    <label class="control-label"><small>ATAX Code</small></label><br>
                                                                    {{ itemtemp.atc.code|default:' N/A ' }}
                                                                </div>
                                                                <div class="form-group col-sm-4">
                                                                    <label class="control-label"><small>Input VAT Type</small></label><br>
                                                                    {{ itemtemp.inputvattype.description|default:' N/A ' }}
                                                                </div>
                                                                <div class="form-group col-sm-4">
                                                                    <label class="control-label"><small>Deferred VAT</small></label><br>
                                                                    {{ itemtemp.get_deferredvat_display|default:' N/A ' }}
                                                                </div>
                                                                <div class="form-group col-sm-4" style="display: none">
                                                                    <label class="control-label"><small>Currency</small></label><br>
                                                                    [{{ itemtemp.currency.symbol }}]&nbsp;&nbsp;&nbsp;{{ itemtemp.currency.description }}
                                                                </div>
                                                                <div class="form-group col-sm-4" style="display: none">
                                                                    <label class="control-label"><small>FX Rate</small></label><br>
                                                                    {{ itemtemp.fxrate }}
                                                                </div>
                                                                {% if itemtemp.oftype.code == 'CSV' %}
                                                                    <div class="form-group col-sm-4">
                                                                        <label class="control-label"><small>Period From</small></label><br>
                                                                        {{ itemtemp.periodfrom|date:'Y-m-d'|default:' N/A ' }}
                                                                    </div>
                                                                    <div class="form-group col-sm-4">
                                                                        <label class="control-label"><small>Period To</small></label><br>
                                                                        {{ itemtemp.periodto|date:'Y-m-d'|default:' N/A ' }}
                                                                    </div>
                                                                {% endif %}
                                                                {% if itemtemp.ofsubtype.id == mealexpense %}
                                                                    <div class="form-group col-sm-4">
                                                                        <label class="control-label"><small>No. of Pax</small></label><br>
                                                                        <span class="no-of-pax">{{ itemtemp.noofpax|default:' N/A ' }}</span>
                                                                        <code class="budget_warning" style="display: none">(Exceeds limit, subject for review.)</code>
                                                                    </div>
                                                                {% endif %}
                                                                <div class="form-group col-sm-4">
                                                                    <label class="control-label"><small>Particulars</small></label><br>
                                                                    <code>{{ itemtemp.particulars }}</code>
                                                                </div>
                                                                <div class="form-group col-sm-4">
                                                                    <label class="control-label"><small>Cashier Remarks</small></label><br>
                                                                    <code>{{ itemtemp.remarks|default:' N/A ' }}</code>
                                                                </div>
                                                                {% if itemtemp.vatrate > 0 %}
                                                                    <div class="form-group col-sm-4">
                                                                        <label class="control-label"><small>Payee TIN</small></label><br>
                                                                        {{ itemtemp.tin|default:' N/A ' }}
                                                                    </div>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        {% include "acctentry/datatabledetail.html" %}
        <div class="row col-md-3">
            <div class="col-md-12">
                <div class="nav-tabs nav-tabs-animate border-profile">
                    <ul class="nav nav-tabs nav-profile">
                        <li role="presentation" class="active"><a data-toggle="tab" href="#profiles" aria-controls="profiles" role="tab">Activity Log</a></li>
                    </ul>
                    <div class="tab-content padding-top-0">
                        <div class="tab-pane active" id="profiles" role="tabpanel">
                            <div class="panel top-profile skill-profile margin-bottom-25">
                                <div class="panel-body small">
                                    <div class="master-degree">
                                        <span class="degree-name text-info">Created&nbsp;By:</span>
                                        <div class="univer-profile">{{ object.enterby }}</div>
                                        <div class="univer-profile">{{ object.enterdate }}</div>
                                    </div>
                                    <div class="master-degree">
                                        <span class="degree-name text-info">Modified&nbsp;By:</span>
                                        <div class="univer-profile">{{ object.modifyby }}</div>
                                        <div class="univer-profile">{{ object.modifydate }}</div>
                                    </div>
                                    <div class="master-degree">
                                        <div class="iconlist">
                                            {% if perms.operationalfund.change_ofmain and object.isdeleted == 0 and object.ofstatus != 'F' and object.ofstatus != 'D' and perms.operationalfund.is_cashier %}
                                                <a href="{% url 'operationalfund:cashierupdate' object.pk %}" data-toggle="tooltip" data-placement="right" data-trigger="hover" data-original-title="Click to Edit" title="" aria-describedby="tooltip850155">
                                                    <button type="button" class="btn btn-floating btn-success btn-sm waves-effect waves-float waves-light">
                                                        <i class="icon_pencil" aria-hidden="true"></i>
                                                    </button>
                                                </a>
                                            {% elif perms.operationalfund.change_ofmain and object.isdeleted == 0 and object.ofstatus != 'A' and object.ofstatus != 'I' and object.ofstatus != 'R' %}
                                                <a href="{% url 'operationalfund:userupdate' object.pk %}" data-toggle="tooltip" data-placement="right" data-trigger="hover" data-original-title="Click to Edit" title="" aria-describedby="tooltip850155">
                                                    <button type="button" class="btn btn-floating btn-success btn-sm waves-effect waves-float waves-light">
                                                        <i class="icon_pencil" aria-hidden="true"></i>
                                                    </button>
                                                </a>
                                            {% endif %}
                                            {% if request.user.id !=  274 %}
                                            {% if perms.operationalfund.delete_ofmain and object.ofstatus == 'F' and object.isdeleted == 0 and object.status == 'A' %}
                                                <a href="{% url 'operationalfund:delete' object.pk %}" data-toggle="tooltip" data-placement="right" data-trigger="hover" data-original-title="Click to Cancel" title="" aria-describedby="tooltip850155">
                                                    <button type="button" class="btn btn-floating btn-danger btn-sm waves-effect waves-float waves-light">
                                                        <i class="icon_trash" aria-hidden="true"></i>
                                                    </button>
                                                </a>
                                            {% endif %}
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

         <div class="col-md-9">
            <div class="right-box-profile">
                <div class="col-md-12">
                <div class="nav-tabs nav-tabs-animate border-profile">
                    <ul class="nav nav-tabs nav-profile">
                        <li role="presentation" class="active"><a data-toggle="tab" href="#profiles" aria-controls="profiles" role="tab">Uploaded List</a></li>
                    </ul>
                    <div class="tab-content padding-top-0">
                        <div class="tab-pane active" id="profiles" role="tabpanel">
                            <div class="panel top-profile skill-profile margin-bottom-25">
                                <div class="panel-body small">
                                    <table class="table table-sm">
                                      <thead>
                                        <tr>
                                          <th scope="col">Filename</th>
                                          <th scope="col">Uploaded By</th>
                                          <th scope="col">Uploaded Date</th>
                                          <th scope="col">View</th>
                                            {% if request.user.id !=  274 %}<th scope="col">Delete</th>{% endif %}
                                        </tr>
                                      </thead>
                                      <tbody>
                                        {% for data in uploadlist %}
                                        <tr>
                                          <th scope="row">{{ data.filename }}</th>
                                          <td>{{ data.enterby.username }}</td>
                                          <td>{{ data.enterdate }}</td>
                                          <td><a href="/media/ofupload/{{ data.filename }}" target="_blank">View</a></td>
                                            {% if request.user.id !=  274 %}<td><button type="button" class="deletefile" data-id="{{ data.id }}" style="color:red">Delete</button> </td>{% endif %}
                                        </tr>
                                        {% endfor %}
                                      </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="right-box-profile">
                <div class="col-md-12">
                <div class="nav-tabs nav-tabs-animate border-profile">
                    <ul class="nav nav-tabs nav-profile">
                        <li role="presentation" class="active"><a data-toggle="tab" href="#profiles" aria-controls="profiles" role="tab">Upload Here</a></li>
                    </ul>
                    <div class="tab-content padding-top-0">
                        <div class="tab-pane active" id="profiles" role="tabpanel">
                            <div class="panel top-profile skill-profile margin-bottom-25">
                                <div class="panel-body small">
                                    <form action="{% url 'operationalfund:upload' %}" method="post" enctype="multipart/form-data">
                                    {% csrf_token %}
                                    <input type="file" name="myfile">
                                    <input type="hidden" name="dataid" value="{{ object.pk }}">
                                    <button type="submit">Upload</button>
                                    </form>

                                    {% if uploaded_file_url %}
                                    <p>File uploaded at: <a href="{{ uploaded_file_url }}">{{ uploaded_file_url }}</a></p>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>
    </div>
</div>
{% endblock page-content %}
{% block extra_js %}
    <script src="{% static 'js/jquery.maskMoney.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/custom-maskMoney.js' %}" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            collapseFields();
            initMaskMoney('amount');

            /** Show other fields **/
            $(document).on('click', '.expand-fields', function(){
                $(this).parent().parent().parent().find('.extra-fields').slideToggle(500);
                if($(this).parent().hasClass('rotate-down')){
                    $(this).parent().removeClass('rotate-down').addClass('rotate-up')
                }
                else{
                    $(this).parent().removeClass('rotate-up').addClass('rotate-down')
                }
            });

            $('.no-of-pax').each(function(){
                var no_of_pax = parseFloat($(this).text());
                var budget_spent = parseFloat($(this).parent().parent().parent().parent().find('.item-amount').text().replace(',',''));
                var budget_limit = parseFloat({{ mealbudget }});
                if(budget_spent/no_of_pax > budget_limit){
                    $(this).parent().find('.budget_warning').show();
                }
                else {
                    $(this).parent().find('.budget_warning').hide();
                }
            });

            function collapseFields(){
                $('.rotate-icon').removeClass('rotate-up').addClass('rotate-down');

                var transTime = 400;
                $('.extra-fields').each(function(){
                    $(this).slideUp(transTime);
                    /* transTime = transTime + 200; */
                });
            }
        });

        $(".deletefile").on('click', function() {
            var con = confirm('Are you sure you want to delete this file?');

            if (con) {
                var fileid = $(this).data('id');
                var id = {{ object.pk }};
                 $.ajax({
                    url: "{% url 'operationalfund:filedelete' %}",
                    type: "post",
                    data: {'id': id, 'fileid': fileid},
                    success: function(response) {
                        location.reload();
                    },
                    error: function(response) {
                        console.debug(response);
                    }
                });

            }

        });



        $("#hr1_approved").on('click', function() {
            var con = confirm('Are you sure you want to approved this Operational Fund Request?');

            if (con) {

                var id = {{ object.pk }};
                $.ajax({
                    url: "{% url 'operationalfund:hrapprove1' %}",
                    type: "post",
                    data: {'id': id,
                            'status': 'A'},
                    success: function(response) {
                    location.reload();
                    }
                });

            }

        });

        $("#hr1_disapproved").on('click', function() {
            var con = confirm('Are you sure you want to disapproved this Operational Fund Request?');

            if (con) {

                var id = {{ object.pk }};
                $.ajax({
                    url: "{% url 'operationalfund:hrapprove1' %}",
                    type: "post",
                    data: {'id': id,
                            'status': 'D'},
                    success: function(response) {
                    location.reload();
                    }
                });

            }

        });

        $("#hr2_approved").on('click', function() {
            var con = confirm('Are you sure you want to approved this Operational Fund Request?');

            if (con) {

                var id = {{ object.pk }};
                $.ajax({
                    url: "{% url 'operationalfund:hrapprove2' %}",
                    type: "post",
                    data: {'id': id,
                            'status': 'A'},
                    success: function(response) {
                    location.reload();
                    }
                });

            }

        });

        $("#hr2_disapproved").on('click', function() {
            var con = confirm('Are you sure you want to disapproved this Operational Fund Request?');

            if (con) {

                var id = {{ object.pk }};
                $.ajax({
                    url: "{% url 'operationalfund:hrapprove2' %}",
                    type: "post",
                    data: {'id': id,
                            'status': 'D'},
                    success: function(response) {
                    location.reload();
                    }
                });

            }

        });

        $("#hr_approved").on('click', function() {
            var con = confirm('Are you sure you want to approved this Operational Fund Request?');

            if (con) {

                var id = {{ object.pk }};
                $.ajax({
                    url: "{% url 'operationalfund:hrapprove' %}",
                    type: "post",
                    data: {'id': id,
                            'status': 'A'},
                    success: function(response) {
                    location.reload();
                    }
                });

            }

        });

        $("#hr_disapproved").on('click', function() {
            var con = confirm('Are you sure you want to disapproved this Operational Fund Request?');

            if (con) {

                var id = {{ object.pk }};
                $.ajax({
                    url: "{% url 'operationalfund:hrapprove' %}",
                    type: "post",
                    data: {'id': id,
                            'status': 'D'},
                    success: function(response) {
                    location.reload();
                    }
                });

            }

        });

        $("#nurse_approved").on('click', function() {
            var con = confirm('Are you sure you want to approved this Operational Fund Request?');

            if (con) {

                var id = {{ object.pk }};
                $.ajax({
                    url: "{% url 'operationalfund:nurseapprove' %}",
                    type: "post",
                    data: {'id': id,
                            'status': 'A'},
                    success: function(response) {
                    location.reload();
                    }
                });

            }

        });

        $("#nurse_disapproved").on('click', function() {
            var con = confirm('Are you sure you want to disapproved this Operational Fund Request?');

            if (con) {

                var id = {{ object.pk }};
                $.ajax({
                    url: "{% url 'operationalfund:nurseapprove' %}",
                    type: "post",
                    data: {'id': id,
                            'status': 'D'},
                    success: function(response) {
                    location.reload();
                    }
                });

            }

        });
    </script>
{% endblock extra_js %}